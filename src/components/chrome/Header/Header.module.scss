.header {
  position: sticky;
  top: 0;
  z-index: 50;
  backdrop-filter: blur(10px);
  background: var(--sb-glass-bg);
  border-bottom: 1px solid var(--sb-border);
}

.inner {
  max-width: var(--page-shell-max-width);
  margin: 0 auto;
  padding: 0.75rem var(--page-shell-inline-padding);
  display: flex;
  align-items: center;
  gap: 1rem;
}

.brand {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-weight: 700;
  letter-spacing: 0.01em;
  color: var(--sb-text);
}

.logo {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 140px;
  height: 38px;
  flex: 0 0 auto;
}

:global(:root[data-mantine-color-scheme='dark']) {
  .logo img {
    filter: invert(1);
  }

  .drawerBrand img {
    filter: invert(1);
  }
}

.drawerBrandLink {
  display: inline-flex;
  align-items: center;
  color: inherit;
  text-decoration: none;
  border-radius: 10px;
}

.logoLink {
  display: inline-flex;
  align-items: center;
  color: inherit;
  text-decoration: none;
  border-radius: 10px;
}

.logoLink:focus-visible {
  outline: 2px solid var(--sb-focus-outline-color);
  outline-offset: 3px;
}

.drawerBrandLink:focus-visible {
  outline: 2px solid var(--sb-focus-outline-color);
  outline-offset: 3px;
}

.drawerTitle {
  font-weight: 700;
  letter-spacing: 0.01em;
  color: var(--sb-text);
}

.drawerSrTitle {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.nav {
  display: flex;
  align-items: center;
  margin-left: auto;
  flex: 1 1 auto;
  min-width: 0;
  padding: 0 0 0 1.8rem;
}

.navList {
  display: flex;
  align-items: center;
  gap: 1.65rem;
  flex-wrap: wrap;

  /* Increase click target without changing perceived layout spacing. */
  :is(a, span) {
    padding: 0.5rem 0.75rem;
    margin: -0.5rem -0.75rem;
    border-radius: var(--mantine-radius-sm);
  }
}

.actions {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.themeToggle {
  --theme-toggle-bg: var(--sb-header-theme-toggle-bg);

  width: calc(2.25rem * 1);
  height: calc(2.25rem * 1);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--mantine-radius-sm);
  border: 1px solid var(--sb-border);
  background: var(--theme-toggle-bg);
  color: var(--sb-header-theme-toggle-fg);
  cursor: pointer;
  transition:
    background-color 160ms ease,
    border-color 160ms ease,
    color 160ms ease;
}

.themeToggle:hover {
  --theme-toggle-bg: var(--sb-header-theme-toggle-hover-bg);
  background: var(--theme-toggle-bg);
  border-color: var(--sb-header-theme-toggle-hover-border);
  color: var(--sb-header-theme-toggle-hover-fg);
}

.sunCore {
  fill: var(--theme-toggle-bg, transparent);
}

/* Hover: make the visible icon crisp (100% opacity) and white. */
:global(:root[data-mantine-color-scheme='dark']) {
  .themeToggle:hover {
    .themeIconStack[data-ready='true'] {
      .themeIconSun {
        opacity: 1;
      }
    }
  }
}

:global(:root[data-mantine-color-scheme='light']) {
  .themeToggle:hover {
    .themeIconStack[data-ready='true'] {
      .themeIconMoon {
        opacity: 1;
      }
    }
  }
}

.themeToggle:focus-visible {
  outline: 2px solid var(--sb-focus-outline-color);
  outline-offset: 2px;
}

.themeIcon {
  width: 18px;
  height: 18px;
}

.themeIconStack {
  position: relative;
  width: 18px;
  height: 18px;
  display: inline-block;
}

.themeIconStack > :global(svg) {
  position: absolute;
  inset: 0;
  transition:
    opacity 520ms ease-in-out,
    transform 520ms ease-in-out;
  transform: scale(1);
}

.themeIconAuto {
  opacity: 0.5;
}

.themeIconFinal {
  opacity: 0;
  transform: scale(1);
}

.themeIconSun,
.themeIconMoon {
  opacity: 0;
}

/* Auto glyph only shows before we know the stored scheme. */
.themeIconStack[data-ready='true'] {
  .themeIconAuto {
    opacity: 0;
  }
}

/*
  Prevent overlap during scheme switching:
  - When switching, fade both final icons to 0.
  - When switching ends, the scheme-specific rules below fade the correct icon back in.
*/
.themeIconStack[data-ready='true'][data-switching='true'] {
  .themeIconSun,
  .themeIconMoon {
    opacity: 0 !important;
  }
}

/*
  Show the active scheme icon based on the root scheme attribute.
  This avoids transient mismatches when React state and the root attribute
  are briefly out of sync (common on first load in private browsing).
*/
:global(:root[data-mantine-color-scheme='dark']) {
  .themeIconStack[data-ready='true'] {
    .themeIconSun {
      opacity: 0.75;
    }

    .themeIconMoon {
      opacity: 0;
    }
  }
}

:global(:root[data-mantine-color-scheme='light']) {
  .themeIconStack[data-ready='true'] {
    .themeIconMoon {
      opacity: 1;
    }

    .themeIconSun {
      opacity: 0;
    }
  }
}

@media (prefers-reduced-motion: reduce) {
  .themeIconStack > :global(svg) {
    transition: none;
  }
}

.mobileMenuControl {
  display: none;
  margin-left: auto;
  color: var(--sb-text);

  :global(.mantine-Burger-burger) {
    background-color: var(--sb-text);
  }

  :global(.mantine-Burger-burger)::before,
  :global(.mantine-Burger-burger)::after {
    background-color: var(--sb-text);
  }
}

.drawerBrand {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 140px;
  height: 38px;
}

.drawerContent {
  background: var(--sb-background, #ffffff);
  color-scheme: var(--sb-color-scheme, light);
  color: var(--sb-text, #111);
}

.drawerHeader {
  border-bottom: 1px solid var(--sb-border, rgba(0, 0, 0, 0.08));
  background: var(--sb-background, #ffffff);
  color: var(--sb-text, #111);

  :global(.mantine-Drawer-title) {
    color: var(--sb-text, #111);
  }

  :global(.mantine-CloseButton-root) {
    color: var(--sb-text, #111);
  }
}

.drawerBody {
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  display: flex;
  flex-direction: column;
  background: var(--sb-background, #ffffff);
  color: var(--sb-text, #111);
}

.mobileNav {
  order: 1;
}

:global(:root[data-mantine-color-scheme='dark']) {
  .drawerContent {
    background: var(--sb-surface-glass-bg);
    color-scheme: dark;
    color: var(--sb-text);
  }

  .drawerHeader {
    border-bottom: 1px solid var(--sb-border);
    background: var(--sb-surface-glass-bg);
    color: var(--sb-text);

    :global(.mantine-Drawer-title) {
      color: inherit;
    }

    :global(.mantine-CloseButton-root) {
      color: inherit;
    }
  }

  .drawerBody {
    background: var(--sb-surface-glass-bg);
    color: var(--sb-text);
  }
}

.drawerUtilities {
  order: 3;
  margin-top: auto;
  padding-top: 0.5rem;
  padding-bottom: 0;
  border-top: 1px solid var(--sb-border);
}

.drawerThemeToggle {
  --theme-toggle-bg: var(--sb-header-theme-toggle-hover-bg);

  width: 100%;
  height: 36px;
  min-height: 36px;
  font-size: var(--mantine-font-size-sm);
  font-weight: 600;
  line-height: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  padding: 0 1.25rem 0 0.85rem;
  border-radius: var(--mantine-radius-sm);
  border: none;
  background: var(--theme-toggle-bg);
  color: var(--sb-header-theme-toggle-hover-fg);
  cursor: pointer;
  transition:
    background-color 160ms ease,
    border-color 160ms ease,
    color 160ms ease;
}

.drawerThemeToggle:focus-visible {
  outline: 2px solid var(--sb-focus-outline-color);
  outline-offset: 2px;
}

.drawerThemeToggleLabel {
  font-size: inherit;
  font-weight: inherit;
  letter-spacing: 0.01em;
  text-align: center;
  line-height: inherit;
  opacity: 0.5;
  transition: opacity 520ms ease-in-out;
}

/* Match the label opacity to the visible icon and fade it during switching. */
.drawerThemeToggle {
  .themeIconStack[data-ready='true'] ~ .drawerThemeToggleLabel {
    opacity: 1;
  }

  .themeIconStack[data-ready='true'][data-switching='true'] ~ .drawerThemeToggleLabel {
    opacity: 0 !important;
  }
}

:global(:root[data-mantine-color-scheme='dark']) {
  .drawerThemeToggle {
    color: var(--sb-on-accent);

    .themeIconStack[data-ready='true'] {
      .themeIconSun {
        opacity: 1;
      }
    }

    .themeIconStack[data-ready='true'] ~ .drawerThemeToggleLabel {
      opacity: 1;
    }
  }
}

.mobileNavList {
  display: flex;
  flex-direction: column;
  gap: 0.9rem;

  /*
    IMPORTANT: Only style direct children (the nav items themselves).
    NavItem renders an inner <span> label; if we style all descendant spans
    we double-apply padding and the <a> becomes ~90px tall.
  */
  > :is(a, span) {
    display: flex;
    align-items: center;
    width: 100%;
    font-size: 1.05rem;
    line-height: 1.2;
    font-weight: 600;
    color: var(--sb-text);
    padding: 0.6rem 0.65rem;
    border-radius: var(--mantine-radius-sm);
    text-decoration: none;
  }

  > :is(a, span):hover {
    background: var(--sb-surface-hover-bg);
  }
}

/* Active item (including Home and Storyblok NavItems). */
.mobileNavItemActive,
.mobileNavList > :is(a, span)[aria-current='page'] {
  font-weight: 750;
  background: var(--sb-surface-active-bg);
}

:global(:root[data-mantine-color-scheme='dark']) {
  .mobileNavList {
    > :is(a, span):hover {
      background: var(--sb-surface-hover-bg);
    }
  }

  .mobileNavItemActive,
  .mobileNavList > :is(a, span)[aria-current='page'] {
    background: var(--sb-surface-active-bg);
  }
}

.mobileActions {
  margin-top: 3.5rem;
  order: 2;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;

  :global(button) {
    width: 100%;
  }
}

.placeholder {
  opacity: 0.7;
  font-size: var(--sb-font-body-size);
  line-height: var(--sb-font-body-line-height);
}

.isLight {
  background: var(--sb-surface);
  border-color: var(--sb-border);

  :global(.navItem) {
    color: var(--sb-text);
  }

  .themeToggle,
  .drawerThemeToggle {
    color: var(--sb-text);
  }
}

@media (max-width: 48em) {
  .inner {
    gap: 0.75rem;
  }

  .nav,
  .actions {
    display: none;
  }

  .mobileMenuControl {
    display: flex;
    align-items: center;
  }
}
